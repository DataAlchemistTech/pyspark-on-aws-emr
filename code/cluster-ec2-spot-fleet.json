{
    "InstanceFleets": [
        {
            "Name": "fleetmaster",
            "InstanceFleetType": "MASTER",
            "TargetOnDemandCapacity": 1,
            "InstanceTypeConfigs": [
                {"WeightedCapacity":1,"BidPriceAsPercentageOfOnDemandPrice":100,"InstanceType":"m5.xlarge"}       
            ]
        },
        {
            "Name": "fleetcore",
            "InstanceFleetType": "CORE",
            "TargetOnDemandCapacity": 8,
            "TargetSpotCapacity": 0,
            "InstanceTypeConfigs": [
                {"WeightedCapacity":4,"BidPriceAsPercentageOfOnDemandPrice":100,"InstanceType":"m4.xlarge"},
                {"WeightedCapacity":4,"BidPriceAsPercentageOfOnDemandPrice":100,"InstanceType":"m4.2xlarge"}
            ]
        },
        {
            "Name": "fleettask",
            "InstanceFleetType": "TASK",
            "TargetOnDemandCapacity":0,
            "TargetSpotCapacity": 16,
            "InstanceTypeConfigs": [

                    {"WeightedCapacity":4,
                     "BidPriceAsPercentageOfOnDemandPrice":100,
                     "InstanceType":"r5a.xlarge"
                    },
                    {"WeightedCapacity":4,
                     "BidPriceAsPercentageOfOnDemandPrice":100,
                     "InstanceType":"r5d.xlarge"
                    },
                    {"WeightedCapacity":4,
                     "BidPriceAsPercentageOfOnDemandPrice":100,
                     "InstanceType":"r4.xlarge"
                    },
                    {"WeightedCapacity":4,
                     "BidPriceAsPercentageOfOnDemandPrice":100,
                     "InstanceType":"m5.xlarge"
                    },
                    {"WeightedCapacity":4,
                     "BidPriceAsPercentageOfOnDemandPrice":100,
                     "InstanceType":"r5.xlarge"
                    }
            ],
            "LaunchSpecifications": {
                "SpotSpecification": {
                    "TimeoutDurationMinutes": 60,
                    "BlockDurationMinutes":60,
                    "TimeoutAction": "TERMINATE_CLUSTER"
                }
            }
        }
    ],
    "bootstrap_action": "bootstrap-action.sh",
    "Configurations": [{
                    "Classification": "spark-env",
                    "Configurations": [{
                    "Classification": "export",
                    "Properties": {
                        "PYSPARK_PYTHON": "/usr/bin/python3"
                    }
                    }]
                },
                {                    
                    "Classification": "spark-defaults",
                    "Properties": {
                        "spark.yarn.stagingDir": "hdfs:///tmp",
                        "spark.yarn.preserve.staging.files": "true",
                        "spark.kryoserializer.buffer.max": "2000M",
                        "spark.serializer": "org.apache.spark.serializer.KryoSerializer",
                        "spark.driver.maxResultSize": "0",
                        "spark.jars.packages": "com.johnsnowlabs.nlp:spark-nlp_2.12:3.1.0"                        
                    }
                },
                {
                    "Classification": "yarn-site",
                    "Properties": {
                        "yarn.nodemanager.resource.memory-mb":"38768M"
                    }
                  }
                ],
    "Ec2SubnetIds": [ "subnet-f384febf", "subnet-9cc763f7", "subnet-440e1c3e" ],  
    "KeepJobFlowAliveWhenNoSteps": true

}